# 各种文件类型转换

相关案例：

[https://github.com/aspose-words/Aspose.Words-for-Java.git](https://github.com/aspose-words/Aspose.Words-for-Java.git)

[https://github.com/aspose-pdf/Aspose.PDF-for-Java.git](https://github.com/aspose-pdf/Aspose.PDF-for-Java.git)

这是在`GitHub`上的，拉去非常慢。建议在`gitee`上创建项目哪里，点击创建项目，下面有一个导入已有的项目。将`GitHub`上的地址给他就可以克隆一个项目过来，拉去速度就快了。但是这两个项目在`gitee`上是有地址的。

# 一、获取jar并安装到maven本地仓库

## 1.1、需要的jar

需要使用的`jar`

![在这里插入图片描述](https://img-blog.csdnimg.cn/20200730155311825.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxODUzNDQ3,size_16,color_FFFFFF,t_70)

这给你个`jar`在文档管理里面有，百度网盘也有。将两个`jar`安装到本地仓库里面，项目中就可以直接调用。

## 1.2、安装jar

> aspose-pdf-18.9.jar 最好放到外面来安装到本地仓库，因为这个所在的 `aspose.pdf  for java 18.9完美破解版,无水印,无使用时间限制`目录中有空格，安装不到本地仓库中。

安装`jar`到本地仓库，参考：[https://blog.csdn.net/u010393325/article/details/84314543](https://blog.csdn.net/u010393325/article/details/84314543)

- 命令

```
mvn install:install-file -DgroupId=groupId引用的名字 -DartifactId=aspose-artifactId引用的名字 -Dversion=版本号 -Dpackaging=jar -Dfile=jar所在的地址
```

> 版本号在jar的末尾有写到。

- 我安装的命令

需要更改`jar`所在的目录。

```
mvn install:install-file -DgroupId=com.aspose -DartifactId=aspose-words -Dversion=19.5 -Dpackaging=jar -Dfile=E:\临时文件\aspose-words-19.5jdk.jar

mvn install:install-file -DgroupId=com.aspose -DartifactId=aspose-pdf -Dversion=18.9 -Dpackaging=jar -Dfile=E:\临时文件\aspose-pdf-18.9.jar
```

## 1.3、maven项目中引入jar

```xml
<dependency>
    <groupId>com.aspose</groupId>
    <artifactId>aspose-pdf</artifactId>
    <version>18.9</version>
</dependency>
<dependency>
    <groupId>com.aspose</groupId>
    <artifactId>aspose-words</artifactId>
    <version>19.5</version>
</dependency>
```



# 二、将word转为PDF

`word`的`.doc`和 `.docx`格式都可以转换。

- 全部代码

> 贴全部代码的目的是为了将所在的包也显示。

```java
package com.word.pdf;

import com.aspose.words.*;

/**
 * @author: stars
 * @date: 2020年 07月 30日 13:58
 **/
public class TestDemo {

    public static void main(String[] args) throws Exception {
        String inputPath = "C:\\Users\\stars\\Desktop\\powerdesigner使用.doc" ;
        String outPath = "C:\\Users\\stars\\Desktop";
        String fileName = "powerdesigner使用";
        setShowInBalloons(inputPath,outPath,fileName);
    }
    /**
     * 将word文档转为PDF文档
     *
     * @param inputPath word文档所在的地址
     * @param outPath 生成pdf输出的地址
     * @param fileName 生成后PDF的名字<b>注意：名字不要带后缀，下面自动封装了。</b>
     * @throws Exception
     */
    private static void setShowInBalloons(String inputPath,String outPath,String fileName) throws Exception {
        Document doc = new Document(inputPath);
        // 获取控制修订外观的RevisionOptions对象
        RevisionOptions revisionOptions = doc.getLayoutOptions().getRevisionOptions();
        // 在引出序号中显示删除修订
        revisionOptions.setShowInBalloons(ShowInBalloons.FORMAT_AND_DELETE);
        // 输出
        doc.save(outPath + "\\" + fileName+ ".pdf");
    }
}
```

效果就不展示了，反正这样就能转换。

